#Kage Library 
#$lib_ver$:0.0.38
#. $(dirname $0)/klib.so
#_k_opt() {
#}
#_k_opt_close(){
#}
_k_loaded_opt(){
   local null
}

_k_opt_help() {
   echo "Option library"
}

_k_opt_opt() {
  local z opts find num n
  opts=( $1 )
  find=$2
  num=$3
  [ $# -lt 2 ] && error_return "_k_opt <src> <find> [<output num>]"
  [ -n "$num" ] || num=1
  for z in $(seq 0 $(( ${#opts[*]} - 1)) ); do
    if [ "$find" == "${opts[$z]}" ]; then
      for n in $(seq 1 $num); do
        echo "${opts[$(($z + $n))]}"
      done
      return 0
      break
    fi
  done
  return 1
}

_k_opt_num() {
  local z opts find n
  opts=( $1 )
  find=$2
  [ $# -lt 2 ] && error_return "_k_opt <src> <find>"
  for z in $(seq 0 $(( ${#opts[*]} - 1)) ); do
    if [ "$find" == "${opts[$z]}" ]; then
      for n in $(seq $(( $z+1))  $(( ${#opts[*]} - 1)) ); do
        if echo ${opts[$n]} | grep "^-" > /dev/null ; then
           echo $(( $n-$z -1))
           return 0
           break
        fi
      done
      echo $(( $n-$z ))
      return 0
      break
    fi
  done
  return 1
}

_k_opt_find() {
  local z opts find n
  opts=( $1 )
  find=$2
  [ $# -lt 2 ] && error_return "_k_opt <src> <find>"
  for z in $(seq 0 $(( ${#opts[*]} - 1)) ); do
    if [ "$find" == "${opts[$z]}" ]; then
      echo $z
      return 0
      break
    fi
  done
  return 1
}

_k_opt_end() {
   local opts
   opts=( $* )
   echo ${opts[$(( ${#opts[*]}-1 ))]}
}

_k_opt2() {
    local input find ss num_input
    input=($1)
    find=$2

    num_input=${#input[*]}
    for ((i=0;i<$num_input;i++)); do
        if [ "$find" == "${input[$i]}" ]; then
            ss=$(($i+1))
            for ((j=$ss; j<$num_input; j++)); do
                echo ${input[$j]} | grep "^-" >/dev/null && break
                (($j==$ss)) || echo -n " "
                echo -n ${input[$j]}
            done
            return 0
        fi
    done
    return 1
}

_k_opt_default() {
    local input find ss num_input
    input=($*)

    num_input=${#input[*]}
    find=""
    for ((i=0;i<$num_input;i++)); do
          echo ${input[$i]} | grep "^-" >/dev/null && break
          find="$find ${input[$i]}"
    done
    [ -n "$find" ] || return 1
    echo $find
    return 0
}

_k_opt_test() {
  opt="-k 1 -h -c -n kage"
  if _k_opt_opt "$opt" -h >/dev/null ; then
    echo "hhhhh"
  fi
  if _K=$(_k_opt_opt "$opt" -k);  then
    echo $_K 
  fi
  echo aaa
}
